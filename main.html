<head>
    <link rel="stylesheet" href="css/validationEngine.jquery.css">
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery.validationEngine.js"></script>
    <script src="js/languages/jquery.validationEngine-ja.js" charset="UTF-8"></script>

<script type="text/javascript">
    $(function(){
        //<form>タグのidを指定
        $("#surveyForm").validationEngine(
            'attach', {
                promptPosition: "topLeft"//エラーメッセージ位置の指定
            }
        );
    });
</script>
</head>


<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お客様満足度アンケート</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #E6F7E6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background-color: #ffffff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            border-top: 10px solid #A8D468;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        .question {
            margin-bottom: 20px;
            transition: all 0.3s ease; /* アニメーションの基本設定 */
        }

        .question label {
            font-size: 18px;
            color: #333;
            display: block;
            margin-bottom: 10px;
        }

        input[type="text"],
        input[type="email"],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s ease; /* アニメーションの基本設定 */
        }

        /* フォーカス時にフィールドが大きくなり、色が変わる */
        input[type="text"]:focus,
        input[type="email"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #A8D468;
            box-shadow: 0 0 10px rgba(168, 212, 104, 0.5);
            transform: scale(1.02); /* フォーカス時に少し拡大 */
        }

        .submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #A8D468;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease; /* アニメーションの基本設定 */
        }

        /* 送信ボタンにホバー効果 */
        .submit-btn:hover {
            background-color: #96c15b;
        }

        /* 送信ボタンのクリック時にバウンド効果 */
        .submit-btn:active {
            transform: scale(0.95); /* 押したときに少し縮む */
        }

        .section-title {
            font-size: 22px;
            color: #A8D468;
            border-bottom: 2px solid #A8D468;
            margin-bottom: 20px;
            padding-bottom: 5px;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #777;
        }

        .mandatory {
            color: red;
        }
         .header {
            background-color: #A8D468;
            padding: 20px;
            text-align: center;
            color: white;
            font-size: 24px;
            border-bottom: 5px solid #8cb755;
        }

        .header .logo {
            display: inline-block;
            margin-right: 10px;
            text-align:left;
        }

        .header h2 {
            display: inline-block;
            margin: 0;
            vertical-align: middle;
        }
        .spinner {
        text-align: center;
        font-size: 18px;
        margin-top: 20px;
        color: #555;
    }
    </style>

    <div class="header">
        <h2>LEOCお客様満足度アンケート</h2>
    </div>

    <div class="container">
        <h1>お客様満足度アンケート</h1>

        <form id="surveyForm" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSc0MfOjmnABJr1JBPn3gZBeCSfOwd1Ln46oTrxXlB6XJqgtFQ/formResponse" method="POST" target="hidden_iframe" onsubmit="submitted=true;" >
            <div class="question">
                <label for="email">メールアドレス<span class="mandatory">※</span></label>
                <input type="text" class="validate[required,custom[email]]" id="email" name="emailAddress" placeholder="メールアドレスを入力してください">
            </div>
            <div class="question">
                <label for="facility">法人名<span class="mandatory">※</span></label>
                <input type="text" id="corporation" name="entry.1113784481" placeholder="施設名を入力してください" class="validate[required]">
            </div>
            <div class="question">
                <label for="facility">施設名<span class="mandatory">※</span></label>
                <input type="text" id="facility" name="entry.329785060" placeholder="施設名を入力してください" class="validate[required]">
            </div>

            <div class="question">
                <label for="department">部署・役職名<span class="mandatory">※</span></label>
                <input type="text" id="department" name="entry.772962082" placeholder="部署・役職名を入力してください" class="validate[required]">
            </div>

            <div class="question">
                <label for="name">お名前<span class="mandatory">※</span></label>
                <input type="text" id="name" name="entry.1223500353" placeholder="お名前を入力してください" class="validate[required]">
            </div>

            <div class="section">
            <h2 class="section-title">1. 弊社（LEOC）の事業所運営について、それぞれの項目を4段階で評価してください。</h2>
            <div class="question">
                <label for="q1_1">お料理の美味しさ</label>
                <select id="q1_1" name="entry.1747016377">
                    <option value=""></option>
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q1_2">メニューバリエーションの豊富さ</label>
                <select id="q1_2" name="entry.1254849263">
                    <option value=""></option>
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q1_3">スタッフの対応（気配り、心遣い）</label>
                <select id="q1_3" name="entry.1306438453">
                    <option value=""></option>
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q1_4">提供の速さ、チームワーク</label>
                <select id="q1_4" name="entry.661821993">
                    <option value=""></option>
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q1_5">衛生ルールの順守、徹底</label>
                <select id="q1_5" name="entry.1515280774">
                    <option value=""></option>
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">2. 弊社（LEOC）・本部スタッフについて、それぞれの項目を4段階で評価してください。<span class="mandatory">※</span></h2>
            <div class="question">
                <label for="q2_1">法人様とのコミュニケーション頻度</label>
                <select id="q2_1" name="entry.36264781" class="validate[required]">
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q2_2">従業員に対する指導力・管理能力</label>
                <select id="q2_2" name="entry.2047483276" class="validate[required]">
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q2_3">要望に対する対応スピード</label>
                <select id="q2_3" name="entry.668672447" class="validate[required]">
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
            <div class="question">
                <label for="q2_4">事業所運営の総合評価</label>
                <select id="q2_4" name="entry.173669550" class="validate[required]">
                    <option value="満足">満足</option>
                    <option value="やや満足">やや満足</option>
                    <option value="やや不満">やや不満</option>
                    <option value="不満">不満</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">3. ご希望の回答方法をお選びください。<span class="mandatory">※</span></h2>
            <div class="question">
                <label for="response_method">回答方法</label>
                <select id="response_method" name="entry.1425153715" class="validate[required]">
                    <option value="WEBでの回答（本アンケートと同様の形）">WEBでの回答（本アンケートと同様の形）</option>
                    <option value="紙媒体での回答">紙媒体での回答</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">4. アンケートの頻度（年2回）についてお選びください。<span class="mandatory">※</span></h2>
            <div class="question">
                <label for="survey_frequency">アンケートの頻度</label>
                <select id="survey_frequency" name="entry.737386493" class="validate[required]">
                    <option value="丁度いい">丁度いい</option>
                    <option value="少ない">少ない</option>
                    <option value="多い">多い</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">5. 弊社（LEOC）との契約内容・サービス内容について、下記よりお選びください。<span class="mandatory">※</span></h2>
            <div class="question">
                <label for="contract">契約内容・サービス内容</label>
                <select id="contract" name="entry.518370999" class="validate[required]">
                    <option value="継続">継続</option>
                    <option value="見直し検討">見直し検討</option>
                    <option value="判断できない">判断できない</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">6. その他ご意見やご要望がございましたら、ご記入ください。</h2>
            <div class="question">
                <label for="comments">ご意見・ご要望</label>
                <textarea id="comments" name="entry.1340586078" rows="5" placeholder="ご意見・ご要望がございましたらご記入ください"></textarea>
            </div>
        </div>
            

            <div class="question">
                <input type="hidden" id="response_code" name="entry.1636953252">
            </div>

            <button class="submit-btn" type="submit">送信する</button>

            <div class="footer">
                <p>ご回答いただきありがとうございます。</p>
            </div>
<script>
    function getParameterByName(name) {
        var url = window.location.href;
        var regex = new RegExp("[?&]" + name + "=([0-9]{6})");  // 6桁の数字に限定
        var results = regex.exec(url);
        return results ? results[1] : null;  // マッチすればその値を返し、無ければnullを返す
}

            // 回答コードをURLから取得し、フォームに設定する
    window.onload = function() {
        var responseCode = getParameterByName('response_code'); // URLのパラメータ名 'response_code' から取得
        if (responseCode) {
            document.getElementById('response_code').value = responseCode; // hiddenフィールドに設定
            }
    }
</script>
            
        </form>
 <script type="text/javascript">
  var submitted = false;
</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display: none" onload="if(submitted)  {window.location='thanks.html';}"></iframe>
        
    </div>
<footer class="footer">
    <div class="footer-content">
        <img src="LEOCヨコ.jpg" alt="Company Logo" class="footer-logo" width="10%" heigth="10%">
        <a href="https://www.leoc-j.com/" target="_blank" class="footer-link">公式ホームページ</a> </div>
        <p>&copy;LEOC Co.,Ltd. All rights reserved.</p>
        
</footer>

    <script>
 $(document).ready(function() {
            // jQuery Validation Engineのバリデーションをフォームに適用
            $("#surveyForm").validationEngine('attach', {
                promptPosition: "topLeft" // エラーメッセージ位置の指定
            });

            // フォーム送信時の処理
            $('#surveyForm').on('submit', function(event) {
                // バリデーションを実行
                if (!$("#surveyForm").validationEngine('validate')) {
                    // バリデーションに失敗した場合
                    event.preventDefault(); // フォーム送信を中断
                    alert('必須項目が入力されていません。すべての項目に入力をお願いします。');
                    return; // 処理をここで終了
                }

                // バリデーションが通った場合のみここに到達

                // 送信ボタンを無効化して連打防止
                var submitButton = document.querySelector('.submit-btn');
                submitButton.disabled = true;
                submitButton.innerHTML = "送信中..."; // 送信中のテキストに変更

                // スピナーの表示
                var spinner = document.createElement('div');
                spinner.className = 'spinner';
                spinner.innerHTML = '送信しています...';
                document.querySelector('.container').appendChild(spinner);
            });
        });
    </script>
